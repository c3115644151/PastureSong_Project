# 牧野之歌 (Pasture Song) 操作文档

## 1. 系统概述 (Overview)
**牧野之歌** 是一个深度生物行为与畜牧管理插件，现已开发完成并包含完整的生态特性。它将原版的简单养殖扩展为包含 **应激管理**、**环境互动**、**基因遗传**、**产出疲劳**、**疾病传播** 以及 **沉浸式 QTE 互动** 的复杂生态系统。玩家不仅需要关注动物的心理健康（应激值）和居住环境，还需通过选育优化血统（基因），并利用特定的技巧（QTE）获取高品质特产。

核心理念是 **“投入与回报的平衡”**：高产出的动物往往伴随着高维护成本（易应激、需频繁清理粪便、易患病），而精准的互动操作则是获取顶级回报的关键。

---

## 2. 核心架构 (Core Architecture)

插件共包含 25 个核心类文件，分为以下 7 个主要模块：

### 2.1 核心与管理 (Core & Management)
| 类文件 | 职责 |
| :--- | :--- |
| `PastureSong.java` | 插件主类，负责所有管理器初始化、配置加载与监听器注册。 |
| `PastureCommand.java` | 处理插件指令（如 `/pasture get`），用于调试和获取开发道具。 |
| `PastureItemManager.java` | 注册和管理自定义物品（基因透镜、DNA采样器、牧场剪刀等）。 |
| `PastureTask.java` | 全局心跳任务（5秒周期），处理应激衰减、随机排泄、疾病判定与粒子效果。 |

### 2.2 基因与遗传系统 (Genetics System)
| 类文件 | 职责 |
| :--- | :--- |
| `GeneticsManager.java` | **[核心]** 负责基因的生成、遗传（孟德尔）、突变逻辑与 PDC 数据存储。 |
| `GeneData.java` | 数据模型，存储单个动物的完整基因组 (4 对等位基因)。 |
| `GenePair.java` | 基因对模型，计算单个性状的表现值（处理显隐性与杂种优势）。 |
| `Trait.java` | 枚举定义，包含 V(生长势), Q(品质), R(抗性), F(多产性) 四大性状。 |
| `Allele.java` | 枚举定义，包含显性/隐性基因及其 1-4 级强度等级。 |

### 2.3 状态与行为系统 (State & Behavior)
| 类文件 | 职责 |
| :--- | :--- |
| `StressManager.java` | **[核心]** 计算基础应激与临时应激，管理应激值的累加与衰减。 |
| `StressListener.java` | 监听伤害、爆炸、天气等外部事件，转化为临时应激值。 |
| `DiseaseManager.java` | **[核心]** 管理疾病系统，包括感染风险计算、症状表现、传染机制与痊愈逻辑。 |
| `ExhaustionManager.java` | 管理动物的“产出疲劳”状态，限制连续高强度采集。 |
| `LifecycleListener.java` | **[核心]** 监听生物生成（初始化基因）与繁殖（遗传/突变），应用生长速度控制。 |

### 2.4 环境与互动 (Environment & Interaction)
| 类文件 | 职责 |
| :--- | :--- |
| `EnvironmentManager.java` | 提供 BFS 算法扫描围栏区域，计算生态容量与区域负载。 |
| `ManureManager.java` | 处理动物排泄（方块替换）逻辑。 |
| `ManureListener.java` | 监听玩家清理粪便的操作，维护牧场卫生。 |
| `ProductionListener.java` | 拦截采集事件，根据基因/应激判定产出，并触发 QTE 或疲劳惩罚。 |
| `ToolListener.java` | 处理基因透镜（查看性状）与 DNA 采样器（提取样本）的交互逻辑。 |

### 2.5 QTE 互动系统 (QTE System)
| 类文件 | 职责 |
| :--- | :--- |
| `QTEManager.java` | **[核心]** QTE 会话管理器，负责启动、停止及清理玩家的当前 QTE 状态。 |
| `QTE.java` | 抽象基类，定义 QTE 的通用流程（开始、结束、成功/失败回调、动物冻结）。 |
| `CowMilkingQTE.java` | 实现奶牛的“节奏挤奶”玩法（按顺序点击）。 |
| `SheepShearingQTE.java` | 实现绵羊的“精准修剪”玩法（光圈判定）。 |
| `ChickenBrushingQTE.java` | 实现鸡的“轻手轻脚”玩法（按住蓄力与惊扰控制）。 |
| `PigTruffleQTE.java` | 实现猪的“寻宝嗅探”玩法（自动寻路与挖掘）。 |

---

## 3. 详细模块解析 (Detailed Module Analysis)

### 3.1 应激系统 (`StressManager.java`)
应激值 (Stress) 是衡量动物心理健康的核心指标，决定了动物是否会生病或停止生产。

*   **计算公式**: `Total Stress = Base Stress + Temporary Stress`
*   **基础应激 (Base)**:
    *   **来源**: 
        *   基因修正: `RESISTANCE` (抗性) 基因越高，基础应激越低。公式: `- (ResistancePhenotype * 5.0)`。
        *   健康状况: 血量低于 80% 时，基础应激随血量降低而升高。公式: `(0.8 - HealthPct) * 50.0`。
        *   **生物疲劳**: 若处于疲劳状态 (Exhausted)，基础应激恒定 **+10.0** (只要疲劳存在)。
*   **临时应激 (Temporary)**:
    *   **来源**: 外部刺激。
        *   **受到伤害**: `Damage * 5.0`。
        *   **爆炸**: 10格范围内，距离越近应激越高 (Max 100)。
        *   **恶劣天气**: 露天且雷雨天，每 5 秒增加 `2.0` (雨) / `4.0` (雷)。
        *   **疲劳交互**: 若处于疲劳状态，强行进行原版交互 (剪毛/挤奶) 每次 **+20.0**。
    *   **衰减**: 每 5 秒自动衰减 `1.0` 点临时应激。
        *   注意: 临时应激最低衰减至 0，这意味着 **Total Stress** 最低会回归到 **Base Stress** 水平。

### 3.2 环境与区域负载系统 (`EnvironmentManager.java`)
区域负载系统 (Area Load System) 是为了平衡牧场规模与养殖密度的核心机制。它通过“容量 vs 负载”的动态对比，决定牧场是否处于健康状态。

*   **圈地识别 (Enclosure Detection)**:
    *   **被动式检测优化 (Passive Detection)**: 系统不再进行高频的循环扫描。而是监听栅栏、墙壁、门等结构性方块的变动（放置/破坏/交互）。只有当牧场结构发生变化时，才会触发 BFS 重新扫描。
    *   **缓存机制**: 扫描结果（圈地大小、草方块数量）会被缓存。只要结构未变，后续计算直接读取缓存，极大降低了性能消耗。
    *   **BFS 扫描**: 当缓存失效时，使用 BFS 算法扫描动物所在的封闭空间。
    *   **有效牧场判定条件 (必须全部满足)**:
        1.  **全泥土环境**: 圈内 **所有** 地面方块必须属于 **泥土类** (`GRASS_BLOCK`, `DIRT`, `COARSE_DIRT`, `PODZOL` 等)。若检测到任何非泥土方块 (如石头、木板)，视为无效牧场。
        2.  **植被要求**: 圈内 **至少有一个** `GRASS_BLOCK` (草方块)。
        3.  **封闭性**: 必须由墙、栅栏或实体方块完全围住。

*   **容量计算 (Capacity Calculation)**:
    *   牧场的生态容量不再使用旧版的对数饱和公式，而是采用 **幂函数 (Power Law)** 增长，以解决小牧场过度拥挤和大牧场利用率低的问题。
    *   **公式**: `Capacity = 0.8 * (Area ^ 0.8)`
        *   `Area`: 牧场的有效面积 (格数)。
    *   **分析**:
        *   小牧场 (20格): 容量约 8.8 (合理密度，不再拥挤)。
        *   中牧场 (100格): 容量约 32 (标准密度)。
        *   大牧场 (500格): 容量约 115 (高回报，奖励大规模放牧)。
    *   **设计目的**: 显著降低超小型“监狱式”养殖的收益，大幅提高大型生态牧场的动物容纳量，鼓励玩家进行大规模圈地。

*   **负载计算 (Load Calculation)**:
    *   **公式**: `Current Load = Σ(Entity Load) + Σ(Manure Load)`
    *   **生物负载**: 不同生物占用不同负载值 (如 Cow=1.5, Sheep=1.0)。
    *   **粪便负载**: 每个未清理的粪便 (`PODZOL`) 占用高额负载 (默认 2.0)，迫使玩家定期清理。

*   **过载惩罚 (Overload Penalty)**:
    *   当 `Current Load > Capacity` 时，牧场进入过载状态。
    *   **应激惩罚**: `Penalty = 50 * (Ratio - 1)^2`
        *   过载 20% (Ratio 1.2): 增加 2.0 基础应激。
        *   过载 50% (Ratio 1.5): 增加 12.5 基础应激。
        *   过载 100% (Ratio 2.0): 增加 50.0 基础应激 (灾难级)。
        *   **特点**: 呈指数级增长，轻微过载可容忍，严重过载会导致动物迅速崩溃。
    *   **土地退化**: 动物脚下的草方块有概率退化为泥土，概率随过载比例增加。

### 3.3 粪便与清理系统 (`ManureManager.java`)
    *   **频率**: 每 5 秒有 **0.1%** 的概率尝试排泄 (已大幅降低)。
    *   **条件**: 
        1.  动物脚下必须是 `GRASS_BLOCK` (草方块) 或 `DIRT` (泥土)。
        2.  **必须位于有效牧场内**: 只有在 `LoadResult.isValid` 为真时才会排泄 (野生动物不会随地大小便)。
    *   **效果**: 将方块替换为 `PODZOL` (灰化土)，并播放泥泞音效。
*   **清理机制**:
    *   **工具**: 任意铲子 (`_SHOVEL`)。
    *   **操作**: 右键点击 `PODZOL`。
    *   **回报**: 方块恢复为 `GRASS_BLOCK`，掉落 `BROWN_DYE` (有机粪肥占位符)。

### 3.3 基因与遗传系统 (`GeneticsManager.java`)
复用了 `CuisineFarming` 的双等位基因架构，定义了 4 种核心性状：

| 基因代号 | 性状 (Trait) | 描述 | 数值影响 |
| :--- | :--- | :--- | :--- |
| **V** | **生长势 (Vitality)** | 决定成熟速度 | **生长速度**: 每点 V 值减少 5% 的幼年时长。 |
| **Q** | **品质 (Quality)** | 决定产物星级 | **特产评级**: 影响特产奶/羊毛的星级判定 (1-5星)。 |
| **R** | **抗性 (Resistance)** | 决定应激阈值 | **基础应激**: 每点 R 值降低 5.0 点基础应激 (及降低患病率)。 |
| **F** | **多产性 (Fertility)** | 决定产量 | **额外掉落**: 提高特产掉落数量与剪毛双倍概率。 |

*   **表现值计算 (Phenotype Calculation)**:
    *   **杂种优势 (Heterosis)**: 当一对等位基因不同 (杂合子, 如 `A1, A2`) 时，其数值加倍。
    *   **公式**: 
        *   `RawSum = Allele1 + Allele2`
        *   若 `Allele1 != Allele2` (杂合): `Score = RawSum * 2.0`
        *   若 `Allele1 == Allele2` (纯合): `Score = RawSum`
    *   **示例**: `[A2, A1]` -> `(2+1)*2 = 6` (强力优势)。

*   **遗传逻辑**:
    *   **初始化**: 自然生成的动物赋予完全随机的基因。
    *   **繁殖**: 子代从父母的每一对等位基因中各随机继承一个 (孟德尔遗传)。
        *   **突变 (Mutation)**: 遗传过程中，每个等位基因有 0.1% 的概率发生突变（等级 +1 或 -1）。
    *   **繁殖限制**:
        *   若父母任一方处于 **高应激状态 (>70)** 或 **患病 (Sick)**，繁殖将失败并产生愤怒粒子效果。
    *   **生长控制**: 在子代生成时，根据 V 基因值立即调整其 `Age` (幼年剩余时长)。
        *   公式: `NewAge = -24000 * (1.0 - V * 0.05)`。
        *   例: V=5 (强壮)，只需 18000 tick (15分钟) 成熟；V=-5 (瘦弱)，需 30000 tick (25分钟)。

### 3.4 产出与疲劳系统 (`ProductionListener.java`)
*   **疲劳机制 (Exhaustion)**:
    *   当玩家获取“特产”后，动物进入疲劳状态。
    *   **时长**: 15 分钟 (900,000 ms)。
    *   **效果**: 
        *   持续播放 `SMOKE` (烟雾) 粒子。
        *   **恒定应激**: 疲劳期间 **Base Stress +10.0** (不再随时间累积)。
        *   **交互惩罚**: 疲劳期间强行交互（剪毛/挤奶）每次增加 **+20.0** 临时应激。

*   **血量成长机制 (Health Scaling)**:
    *   **基础血量 (Base Health)** (已下调 ~30%):
        *   **牛**: 21 (10.5颗心)
        *   **猪**: 17 (8.5颗心)
        *   **羊**: 14 (7颗心)
        *   **鸡**: 8 (4颗心)
    *   **基因加成 (Star Multiplier)**:
        *   *注：此处的星级基于所有基因的算术平均值计算 (General Rating)。*
        *   **1星**: +50% (1.5x)
        *   **2星**: +100% (2.0x)
        *   **3星**: +150% (2.5x)
        *   **4星**: +200% (3.0x)
        *   **5星**: +250% (3.5x)
    *   *示例*: 一只 5星神牛血量为 `21 * 3.5 = 73.5` 点 (36.75颗心)。

*   **基因随机算法优化 (Gene Randomization)**:
    *   为了防止野生动物过于强大，自然生成的基因现在遵循加权分布：
        *   **Level 1 (±1)**: 60%
        *   **Level 2 (±2)**: 30%
        *   **Level 3 (±3)**: 9%
        *   **Level 4 (±4)**: 1% (极其稀有)
    *   正负值概率各 50%。这意味着大多数野生动物将拥有普通的 1-2 级基因。

*   **产出计算机制 (Output Calculation)**:
    *   **A. 动物掉落 (Animal Drops)**:
        *   **基础数量**: 基于现实体量调整（如牛 30-63 肉），而非简单的 10 倍。
        *   **通用公式**: `Final = Base * (1 + Butchery + Stress) * (1 + Fertility) + Looting`
        *   **变量说明**:
            *   **Butchery (屠宰)**: 
                *   **伤害加成**: 屠宰刀基础伤害 7。对动物攻击时触发特效：基础增加 200% 伤害 (+14)，且每级附魔额外 +10 伤害。
                    *   *公式*: `Damage = 7 (Base) + 14 (Bonus) + (Level * 10)`
                    *   *示例*: 1 级屠宰刀对动物造成 31 点伤害。
                *   **掉落加成**: I: +25%, II: +50%, III: +75%。
            *   **Stress (应激)**:
                *   `<= 0.1` (完美): **+25%**
                *   `0.1 - 20`: **+0%** (无修正)
                *   `21 - 50`: **-30%**
                *   `51 - 70`: **-50%**
                *   `71 - 90`: **-70%**
                *   `91 - 100`: **-90%**
            *   **Fertility (多产性)**: 基因分数每点 +10% (如 5分 -> +50%)。
            *   **Looting (抢夺)**: 每一级固定增加 1 个单位的基础掉落。

    *   **B. 特产产出 (Specialty Drops)**:
        *   **前置条件**: 必须在有效牧场内 + 符合生物群系要求 + 动物未疲劳。
        *   **数量公式**: `Multiplier = 1.0 + (FertilityScore / 10.0)`。
            *   例如分数 14 -> 2.4倍。
            *   处理逻辑: **必定掉落 2 个** (整数部分) + **40% 概率额外掉落 1 个** (小数部分)。
    
    *   **C. 品质星级 (Quality Stars)**:
        *   *注：此处的星级基于品质基因主导的加权公式计算 (Production Rating)。*
        *   **评分公式**: `Score = (QualityGene * 0.5) + (AvgOtherGenes * 0.5)`。
            *   综合考察品质基因与其他基因的平均水平。
        *   **星级映射** (分数范围 -14 ~ +14):
            *   `>= 8.0`: **★★★★★** (5星)
            *   `>= 2.0`: **★★★★☆** (4星)
            *   `>= -2.0`: **★★★☆☆** (3星)
            *   `>= -8.0`: **★★☆☆☆** (2星)
            *   `< -8.0`: **★☆☆☆☆** (1星)
        *   **应激惩罚**:
            *   应激 > 30: **-1 星**
            *   应激 > 70: **-2 星**
            *   应激 > 99: **强制 1 星** (废品)

*   **交互逻辑**:
    *   **挤奶 (Cow)**:
        *   `BUCKET`: 原版挤奶，若疲劳则增加应激。
        *   `GLASS_BOTTLE`: **特产挤奶**。检查牧场/群系/疲劳 -> 成功则给予特产奶并触发疲劳。
    *   **剪毛 (Sheep)**:
        *   `SHEARS`: 原版剪毛/特产剪毛通用工具 (视是否触发特产判定而定)。
    *   **刷毛 (Chicken)**:
        *   `BRUSH`: 获取特产羽毛。
    *   **挖掘 (Pig)**:
        *   `GOLDEN_SHOVEL`: 获取特产松露。

---

## 3.5 疾病系统 (Disease System)
*(New 2025-12-26)*
疾病系统模拟了恶劣环境和高压状态对动物健康的负面影响。生病的动物不仅会遭受持续的痛苦（应激增加），还会成为传染源威胁整个牧场。

### 3.5.1 感染风险与判定
系统每 5秒 (100 ticks) 对动物进行一次健康检查，判定是否染病。

**风险来源**:
1.  **环境过载 (Manure/Overload)**: 
    *   `Risk += (OverloadRatio - 1.0) * 0.1`
    *   例如：150% 负载 (Ratio 1.5) 增加 5% 风险系数。
2.  **高应激 (High Stress)**:
    *   若应激值 > 70.0，`Risk += 0.02` (2% 风险系数)。
3.  **基因修正 (Resistance)**:
    *   抗性基因 (RESISTANCE) 显著影响风险。
    *   `Risk -= (ResistanceValue * 0.01)`。
    *   例如：抗性 +10 (Phenotype) 降低 10% 风险系数。

**判定公式**:
*   `FinalChance = Risk * 0.01` (实际每 5秒 触发概率为风险系数的 1/100)。
*   例如：总风险系数 0.1 (10%) -> 实际每 5秒 0.1% 几率染病。

### 3.5.2 症状与流感 (Influenza)
染病动物会有以下表现：
*   **视觉效果**: 间歇性喷嚏粒子效果 (SNEEZE particle)。
*   **应激增加**: 每 5秒 增加 2.0 临时应激。
*   **流感 Buff**: 
    *   动物会持续遭受轻微伤害 (每 5秒 10% 概率受到 1.0 伤害)。
    *   该伤害极其缓慢，但若不加干预最终会导致动物死亡。

### 3.5.3 传染机制 (Transmission)
染病动物每 5秒 有 1% 概率尝试向周围 5格 内的生物传播疾病。

**传播优先级**:
1.  **同类传播**: 优先传染给同种动物 (100% 成功率，受抗性减免)。
2.  **异种传播**: 若无同类，传染给其他家畜 (100% 成功率，受抗性减免)。
3.  **人畜共患**: 若无动物，传染给玩家。
    *   玩家获得 **流感 (Influenza)** 状态：虚弱 (Weakness) + 缓慢 (Slowness) 持续 30秒。
    *   玩家收到提示消息："你感觉有些头晕... (感染流感)"。

### 3.5.4 痊愈与恢复
若满足以下条件，动物有概率自然痊愈：
*   **低应激**: 总应激值 < 30.0。
*   **健康状态**: 血量 > 80%。
*   **恢复概率**: `5% + (ResistanceValue * 1%)` / 每 5秒。

---

## 3.6 基因突变机制 (Genetic Mutation)
*(New 2025-12-26)*
基因不再是一成不变的，它们会随着繁殖和环境压力发生改变。

### 3.6.1 自然繁殖突变
*   **时机**: 动物交配产生后代时。
*   **概率**: 每个等位基因有 **0.1%** 概率发生突变。
*   **效果**: 等位基因值随机 +1 或 -1 (50%/50%)。

### 3.6.2 环境诱导恶性突变
*   **时机**: 动物存活期间，每 5秒 进行一次判定。
*   **触发条件**: 
    *   动物处于 **高应激状态 (>70.0)**。
    *   或 牧场处于 **过载状态 (Overloaded)**。
*   **概率**: 满足条件时，每 5秒 有 **1%** 概率触发突变检查。
*   **效果**: 
    *   检查触发后，有 **50%** 概率发生实际突变 (即总概率 0.5% / 5s)。
    *   **恶性突变**: 基因值 **强制 -1** (降级)。
    *   **视觉反馈**: 动物周围出现黑色烟雾粒子。

---

## 3.7 QTE 互动玩法 (QTE Mechanics)
*(New 2025-12-26)*

为了增加畜牧的沉浸感与乐趣，特产的获取不再是简单的右键点击，而是需要通过特定的 QTE (Quick Time Event) 互动挑战。只有成功完成挑战，才能获得高品质的特产回报。

### 3.7.1 核心机制
*   **触发条件**: 
    *   持有对应工具 (如特产剪刀、玻璃瓶、刷子、金铲)。
    *   牧场环境健康 (LoadResult.isValid)。
    *   动物未处于疲劳状态。
*   **动物冻结**: 在 QTE 进行期间，目标动物会被冻结 (无法移动)，以免干扰操作。
*   **结果判定**:
    *   **成功**: 掉落特产，动物进入疲劳状态。
    *   **失败**: 动物受到惊吓 (增加大量应激)，仅掉落普通物品或无掉落。

### 3.7.2 各生物玩法详解

#### A. 奶牛：节奏挤奶 (Rhythm Milking)
*   **工具**: `GLASS_BOTTLE` (玻璃瓶)
*   **玩法**: 
    *   **时限**: 必须在 **5秒** 内完成。
    *   **指令**: 屏幕中央清晰显示当前需要的按键（左键/右键）。
    *   **倒计时**: 实时显示剩余时间，增加紧张感。
    *   **操作**: 玩家需迅速且准确地按照提示按下鼠标，模拟挤奶时的手部节奏动作。
*   **沉浸感**: 只有手法熟练且反应迅速的牧场主才能挤出醇香的特产奶。

#### B. 绵羊：精准修剪 (Precision Shearing)
*   **工具**: `PASTURE_SHEARS` (牧场剪刀, CustomModelData: 30003)
*   **玩法**: 
    *   动物脚下生成一个扩大的粒子光圈。
    *   光圈颜色随大小变化：白色(准备) -> **绿色(最佳时机)**。
    *   **判定优化**: 绿色判定区间已大幅放宽 (0.75秒)，且粒子效果更加清晰，降低视觉干扰。
    *   玩家需在光圈变为绿色时按下右键。
*   **沉浸感**: 模拟剪毛时寻找最佳下刀时机的专注感。

#### C. 鸡：轻手轻脚 (Stealth Brushing)
*   **工具**: `BRUSH` (刷子)
*   **玩法**: 
    *   **时限**: 必须在 **12秒** 内完成。
    *   **双重条**: ActionBar 同时显示 **舒适度** (目标) 和 **惊恐值** (风险)。
    *   **操作**: 玩家按住右键增加进度，但同时会增加惊扰值。必须适时松手安抚，防止惊扰值爆表。
    *   **博弈**: 为了在时限内完成，玩家必须尽可能快地刷，但过快会导致惊恐值失控。
*   **沉浸感**: 模拟给胆小的鸡梳理羽毛时的小心翼翼与时间赛跑。

#### D. 猪：寻宝嗅探 (Truffle Hunting)
*   **工具**: `GOLDEN_SHOVEL` (金铲)
*   **玩法**: 
    *   **阶段一 (嗅探)**: 猪会自动寻路前往松露埋藏点。
    *   **阶段二 (挖掘)**: 猪头顶出现感叹号 `!`，开始挖掘地面。
    *   **循环**: 猪会连续寻找 3 个挖掘点，每次挖掘都会掉落特产松露。
    *   **疲劳**: 3 次挖掘结束后，猪会因为体力耗尽而原地休息 (进入疲劳状态)。
*   **沉浸感**: 还原训练有素的松露猪在林间搜寻宝藏的过程，无需玩家手动挖掘。

---

## 4. 道具与工具 (Items & Tools)

*(Updated 2025-12-26)*

为了方便玩家进行选育和基因管理，插件提供了以下工具：

### 4.1 基因透镜 (Genetic Lens)
*   **物品**: `GENETIC_LENS` (材质: 望远镜)
*   **功能**: 实时观测动物的基因表现。
*   **使用**:
    *   手持透镜 **右键点击** 动物。
    *   **效果**: 在动物头顶显示全息浮空字，列出 4 项性状特征的描述（如“强壮”、“鲜嫩”等）及颜色标识（绿色为正，红色为负）。
    *   *注: 仅显示表现型描述，无法查看具体基因数值。*

### 4.2 DNA 采样器 (DNA Sampler)
*   **物品**: `DNA_SAMPLER` (材质: 燧石)
*   **功能**: 提取动物的基因样本以供深入分析。
*   **使用**:
    *   手持采样器 **右键点击** 动物。
    *   **代价**: 动物受到 1.0 点伤害，增加 15.0 点临时应激。
    *   **产出**: 获得一份 **未鉴定的 DNA 样本** (`DNA Sample (Unidentified)`)。

### 4.3 屠宰刀 (Butcher Knife)
*   **物品**: `BUTCHER_KNIFE` (材质: 铁剑)
*   **功能**: 专门用于屠宰牲畜，获取肉类。
*   **特性**:
    *   **基础伤害**: 7 点。
    *   **动物克星**: 攻击动物时额外造成 200% 伤害 (+14)，且每级屠宰附魔额外增加 10 点伤害。
    *   **精准打击**: 即使只有基础属性，也能一击必杀大多数普通牲畜。

### 4.4 精工剪 (Pasture Shears)
*   **物品**: `PASTURE_SHEARS` (材质: 铁锄)
*   **功能**: 采集羊毛的专用工具。
*   **特性**:
    *   使用铁锄材质以避免原版剪刀的冲突。
    *   **右键点击** 绵羊触发 **剪毛 QTE**。
    *   **高效采集**: 相比原版剪刀，能触发更复杂的互动逻辑（如完美剪毛）。
    *   **产出**: 获得羊毛，并有概率根据基因产出特产羊毛。

---

## 5. 全面测试清单 (Comprehensive Test Checklist)

### 5.2 基因系统测试
- [ ] **采样**: 右键动物，动物受伤并惨叫，玩家获得未鉴定样本。
- [ ] **繁殖遗传**:
    - [ ] 父母均为高 V (如 +2)，子代生长速度明显加快。
    - [ ] 父母均为低 R (如 -2)，子代基础应激值较高。
    - [ ] 杂种优势验证：父母基因不同 (A1, A2) 时，表现型数值是否翻倍。

### 5.3 应激与疾病测试
- [ ] **环境应激**:
    - [ ] 露天雨天 -> 应激值缓慢增加，出现水花粒子。
- [ ] **自然痊愈**: 将患病动物移至舒适环境 (无负载、低应激)，观察是否随时间自愈。

### 5.5 QTE 互动测试

- [ ] **猪 (寻宝)**:
    - [ ] 手持金铲右键 -> 猪开始跑动。
    - [ ] 跟随猪 -> 猪挖掘 -> 掉落松露。
    - [ ] 3次挖掘后 -> 猪进入疲劳状态 (冒烟)。




